<div id="comments" class="mt-5">
    <h3>{{ 'blogpost.comments.headline'|trans }}</h3>
    {% if blogpost.comments is empty %}
        {{ 'blogpost.comments.no-comments'|trans }}
    {% else %}

        {# comments.twig #}
        {% macro render_comments(comments, indent = false) %}
            <ul class="list-unstyled{% if indent == true %} ms-4{% endif %}">
                {% for comment in comments %}
                    <li class="my-3">
                        <small><b>{{ comment.name }}</b> am {{ comment.dateTime|date('d.m.Y') }} um {{ comment.dateTime|date('H:i') }} Uhr</small><br>
                        <div class="border-bottom pb-3">{{ comment.comment }}</div>
                        {% if comment.children is not empty %}
                            {{ _self.render_comments(comment.children, true) }}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% endmacro %}

        {# Im Haupttemplate aufrufen: #}
        {{ _self.render_comments(comments) }}
    {% endif %}

    {# Comment Form #}
    {% if commentForm.errors != null or commentForm.isHandled == false %}
        <h3 class="mt-5">{{ "blogpost.comments.yourComment"|trans }}</h3>
        {% set captcha = commentForm.getCaptcha() %}
        {% set form = commentForm.getFormView() %}
        {{ dump(commentForm.errors) }}
        {{ form_start(form) }}
        <div class="form-group">
            <textarea
                placeholder="{{ "blogpost.comments.form.comment.placeholder"|trans }}"
                name="{{ field_name(form.comment) }}"
                class="form-control"
                rows="5"
            >{{ form.comment.vars.value|default('') }}</textarea>
        </div>

        <div class="row g-2 mt-3">
            <div class="form-group col-12 col-md-4 mt-2 mt-md-0">
                <input
                    placeholder="{{ "blogpost.comments.form.name.placeholder"|trans }}"
                    name="{{ field_name(form.name) }}"
                    class="form-control"
                    value="{{ form.name.vars.value|default('') }}"
                >
            </div>
            <div class="form-group col-12 col-md-4 mt-2 mt-md-0">
                <input
                    placeholder="{{ "blogpost.comments.form.email.placeholder"|trans }}"
                    name="{{ field_name(form.email) }}"
                    type="email"
                    class="form-control"
                    value="{{ form.email.vars.value|default('') }}"
                >
            </div>

            <div class="form-group col-12 col-md-4 mt-2 mt-md-0">
                <input
                    placeholder="{{ "blogpost.comments.form.website.placeholder"|trans }}"
                    name="{{ field_name(form.website) }}"
                    class="form-control"
                    value="{{ form.website.vars.value|default('') }}"
                >
            </div>
        </div>

        <div class="form-group mt-3">
            <small class="mx-2">Was ergibt {{ captcha.firstNumber }} {{ captcha.operand }} {{ captcha.secondNumber }}?</small>
            <input
                placeholder="{{ "blogpost.comments.form.result.placeholder"|trans }}"
                name="{{ field_name(form.result) }}"
                type="number"
                class="form-control"
            >
        </div>

        <div class="form-group mt-3">
            <input
                type="hidden"
                value="{{ captcha.cacheKey }}"
                name="{{ field_name(form.cake) }}"
            >
            <input
                type="hidden"
                value="{{ blogpost.id }}"
                name="{{ field_name(form.pid) }}"
            >
            <input
                type="submit"
                class="js-recaptcha"
                value="{{ "blogpost.comments.form.button.value"|trans }}"
                name="{{ field_name(form.submit) }}"
            >
        </div>
        {{ form_rest(form) }}
        {{ form_end(form) }}
    {% endif %}
</div>
